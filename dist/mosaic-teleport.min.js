/*! mosaic-teleport 2014-07-11 */
require=function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){(function(c){!function(a){"use strict";var d=b.exports=a("mosaic-commons");a("./Mosaic.PathMapper");{var e="undefined"!=typeof window?window._:"undefined"!=typeof c?c._:null,f=d.P,g=d.Class,h=d.PathMapper,i=d.Errors,j=d.ApiDescriptor=g.extend({initialize:function(){this._config={},this.mapper=new h},add:function(a,b,c){var d=this._config[a]=this._config[a]||{};return d[b]=c,this.mapper.add(a,d),this},get:function(a){return this.mapper.find(a)}});j.HttpServerStub=g.extend({initialize:function(a,b){this.options=b||{},this.descriptor=a},handle:function(a,b){var c=this;f.then(function(){return c._doHandle(a,b)}).then(function(a){b.send(200,a||"")},function(a){var c=i.toJSON(a),d=c.code||500;b.send(d,c)}).done()},_getInstance:function(){var a=this.options||{},b=a.instance||this;return b},_callMethod:function(a,b,c,d){var f=this._getInstance(c,d,a,b),g=f[a];if(!g)throw i.newError('Method "'+a+'" is not implemented').code(500);var h=e.extend({},c.query,c.body,b);return g.call(f,h)},_doHandle:function(a,b){var c=this,d=c._getPath(a),e=a.method.toLowerCase(),f=c.descriptor.get(d);if(!f)throw i.newError('Path not found "'+d+'"').code(404);var g=f.obj[e];if(!g)throw i.newError('HTTP method "'+e.toUpperCase()+'" is not supported. Path: "'+d+'".').code(404);return c._callMethod(g,f.params,a,b)},_getPath:function(a){var b=a.path;if(!b||""===b){var c=a.url||"",d=c.indexOf("?");d>=0&&(c=c.substring(0,d)),d=c.indexOf("#"),d>=0&&(c=c.substring(0,d)),d=c.indexOf("/"),d>0&&(c=c.substring(d)),b=c}var e=this.options||{},f=e.pathPrefix||"";return b.substring(f.length)}}),j.HttpClientStub=g.extend({initialize:function(a,b){this.descriptor=a,this.options=b||{};var c=this,d=this.descriptor._config;e.each(d,function(a,b){e.each(a,function(a,d){c[a]=function(a){var e=c._newHttpRequest(b,d,a),f=c._newHttpResponse(e);return c.handle(e,f)}})})},_newHttpRequest:function(a,b,c){c=c||{};var d=h.formatPath(a,c),f=this._toUrl(d);return{id:e.uniqueId("req-"),url:f,method:b,query:{},headers:{},body:c||{}}},_newHttpResponse:function(a){return{id:a.id,status:200,headers:{},body:null,error:null}},_beginHttpCall:function(){},_endHttpCall:function(){},handle:function(a,b){var c=this,d=f.defer();try{c._beginHttpCall(a,b),c._http(a,b,function(e){try{if(!e){var f=parseInt(b.status)/100;f=100*parseInt(f),200!=f&&(e=b.body&&b.body.trace?i.fromJSON(b.body).code(b.status):i.newError(""+b.status).code(b.status))}if(e)throw e;c._endHttpCall(a,b),d.resolve(b.body)}catch(g){c._endHttpCall(a,b),d.reject(g)}})}catch(e){d.reject(e)}return d.promise},_toUrl:function(a){var b=this.options||{},c=b.baseUrl||"";return c+a},_http:function(a,b,c){c(new Error("Not implemented"))}})}d.ApiDescriptor=j}(a)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./Mosaic.PathMapper":2,"mosaic-commons":"2iUeNl"}],2:[function(a){(function(b){!function c(a){"use strict";function d(){function a(a){return a.replace(c,"\\$&")}function b(a){return"("+a+")"}var c=/[\-{}\[\]+?.,\\\^$|#\s]/g,d=[];this.add=function(c,e){var g=[],h=[],i=!1;f.each(c.split("*"),function(c){var d=!1;f.each(c.split(":"),function(c){if(i||d){if(i||d){var e=c.indexOf("/"),f=d?"[^/]+":".*?";e>=0?(g.push(b(f)),h.push(c.substring(0,e)),g.push(a(c.substring(e)))):(g.push(b(f)),h.push(c))}}else g.push(a(c));d=!0}),i=!0});var j=g.join(""),k=new RegExp("^"+j+"$");d.push({mask:c,regexp:k,names:h,obj:e})},this.find=function(a){var b=null;return f.any(d,function(c){if(c.regexp.test(a)){var d={},e=c.regexp.exec(a).slice(1),g=0;return f.each(e,function(a){var b=c.names[g++],e=a?decodeURIComponent(a):null;d[b]=e}),b={params:d,obj:c.obj},!0}}),b}}var e=c.exports=a("mosaic-commons"),f="undefined"!=typeof window?window._:"undefined"!=typeof b?b._:null;d.formatPath=function(a,b){b=b||{};for(var c=a.split(/[:\*]/gim),d=[],e=0;e<c.length;e++){var f=c[e];if(0===e)""!==f&&d.push(f);else{var g=null,h=f.indexOf("/");h>=0?(g=f.substring(0,h),f=f.substring(h)):(g=f,f=null);var i=b[g];if(!i){var j='Required parameter "'+g+'" not defined.',k=new Error(j);throw k._code=400,k}delete b[g],d.push(i),f&&""!==f&&d.push(f)}}return d.join("")},e.PathMapper=d}(a)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"mosaic-commons":"2iUeNl"}],"mosaic-teleport":[function(a,b){b.exports=a("H99CHA")},{}],H99CHA:[function(a,b){b.exports=a("mosaic-commons"),a("./Mosaic.ApiDescriptor"),a("./Mosaic.PathMapper")},{"./Mosaic.ApiDescriptor":1,"./Mosaic.PathMapper":2,"mosaic-commons":"2iUeNl"}]},{},["H99CHA"]);